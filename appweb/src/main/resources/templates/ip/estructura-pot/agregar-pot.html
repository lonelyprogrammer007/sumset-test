<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="/header :: headFragment">
<meta charset="UTF-8">
<title id="pageTitle">Agregar POT</title>
</head>
<link rel="stylesheet" type="text/css" th:href="@{/css/ip/componentes.css}">
<body>
	<header th:replace="/home:: header"></header>
	<nav aria-label="breadcrumb">
		<ul class="breadcrumb" id="migas">
			<li class="breadcrumb-item"><em class="fa fa-home">&nbsp;&nbsp;|&nbsp;&nbsp;</em>Instrumentos de planeación</li>
			<li class="breadcrumb-item " aria-current="page">Plan de ordenamiento territorial</li>
			<li class="breadcrumb-item active" aria-current="page"><a th:href="@{/consultar-pot-ip}">Creación de la estructura POT</a></li>
			<li class="breadcrumb-item active" aria-current="page" id="act">Creación plan de ordenamiento territorial</li>
		</ul>
	</nav>
	<div class="form-container3">
		<div class="abs-center">
			<span>Registro del plan de ordenamiento territorial</span><br>
		</div>
		<div class="hr-1"></div>
<br><br>
		<form th:action="@{crear-editar-pot}" th:object="${pot}" id="form"
			method="post">
			<input type="hidden" name="idPot" id="idPot">
			<div class="row mt-2">
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Código del plan </label>
					</div>
				</div>
				<div class="col-sm-2">
					<input type="text" name="codigoPot" id="codigoPot"
						class="form-control required disenioInput" maxlength="10"
						placeholder="longitud 10">
				</div>
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">N° de Acto Administrativo:</label>
					</div>
				</div>
				<div class="col-sm-4">
					<input type="text" id="actoAdministrativo"
						name="actoAdministrativo"
						class="form-control required disenioInput" maxlength="10"
						placeholder="longitud 10">
				</div>
			</div>
			<div class="row mt-2">
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Año Inicio </label>
					</div>
				</div>
				<div class="col-sm-2">
					<input type="text" name="yearInicio" id="yearInicio"
						class="form-control disenioInput numero inicial required"
						maxlength="4" placeholder="longitud 4">
				</div>
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Fecha</label>
					</div>
				</div>
				<div class="col-sm-4">
					<input type="date" name="fecha" id="fecha"
						class="form-control required disenioInput">
				</div>
			</div>
			<div class="row mt-2">
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Año Final </label>
					</div>
				</div>
				<div class="col-sm-2">
					<input type="text" name="yearFin" id="yearFin"
						class="form-control disenioInput numero final required"
						maxlength="4" placeholder="longitud 4">
				</div>
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Estado</label>
					</div>
				</div>
				<div class="col-sm-4">
					<input type="text" class="form-control disenioInput required"
						id="estado" name="estado" value="Vigente" readonly="readonly">
				</div>
			</div>

			<div class="row mt-2">
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">N° Años </label>
					</div>
				</div>
				<div class="col-sm-2">
					<input type="text" id="total"
						class="form-control disenioInput total" maxlength="4"
						disabled="disabled">
				</div>
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">URL de consulta: </label>
					</div>
				</div>
				<div class="col-sm-4">
					<input type="text" name="url" id="url"
						class="form-control disenioInput" placeholder="Longitud 200"
						maxlength="200">
				</div>
			</div>
			<div class="row mt-2">
				<div class="col-sm-3">
					<div align="right" class="mt-2">
						<label class="texto">Tipo Acto Administrativo</label>
					</div>
				</div>
				<div class="col-sm-2">
					<select class="form-control caja required" id="idLsAdoptado"
						name="idLsAdoptado">
						<option value="">Seleccione una opción</option>
						<option th:each="adoptado: ${adoptados}"
							th:value="${adoptado.idArgumento}"
							th:text="${adoptado.resultado}">
					</select>
				</div>

			</div>
			<div class="mt-1" align="right">

				<a th:href="@{/consultar-pot-ip}" id="cancelar">Cancelar</a><span>&nbsp;&nbsp;</span>
				
				<button style="width: auto !important;" class="btn_guardar"
					type="submit">
					<img src="css/img/icono-guardar.png" class="iconGuardar" alt="Icono guardar"> Guardar
				</button>

			</div>
		</form>
	</div><br><br>
	<footer th:replace="/home:: footer"></footer>
</body>
<script th:inline="javascript">
		$(document).ready(function() {
			/*<![CDATA[*/
			var mensajeRes = /*[[${messageRespuesta}]]*/;
			var potDTO = /*[[${potDTO}]]*/
				
			var editar=/*[[${editar}]]*/;
			
			if(editar==1){
			if(potDTO!=null){
			document.getElementById("act").innerHTML = "Edición plan de ordenamiento territorial";	
			document.getElementById("idPot").value=potDTO.idPot;
			document.getElementById("codigoPot").value=potDTO.codigoPot;
			document.getElementById("idLsAdoptado").value=potDTO.idLsAdoptado;
			
			var anioFin = document.getElementById("yearFin").value=potDTO.yearFin;
			var anioInicio = document.getElementById("yearInicio").value=potDTO.yearInicio;
			
			document.getElementById("estado").value=potDTO.estado;
			document.getElementById("fecha").value=potDTO.fecha;
			document.getElementById("actoAdministrativo").value=potDTO.actoAdministrativo;
			document.getElementById("url").value=potDTO.url;
			if(anioFin!=null){
				document.getElementById("total").value=anioFin-anioInicio;
			}
			}
			}
			console.log(mensajeRes);
			
			   if (mensajeRes != null){
			       Swal.fire({
					        title: 'Información',
					        text: mensajeRes,
					        icon: 'info',
					        confirmButtonText: 'Aceptar',
					        allowOutsideClick: () => false
					  }).then((result) => {
						  if (result.value) {
						  window.location = "consultar-pot-ip";  
					  }
					  })
		     }

		  
		/*]]>*/
		$('#form').submit(function(e) {
			var array = $('.required');
			var bandera = false;
			for (var i = 0; i < array.length; i++) {
				if($(array[i]).val()==="" || $(array[i]).val===undefined){
					$(array[i]).addClass('vacio');
					
					bandera = true;
				}else{
					$(array[i]).removeClass('vacio');
				}
			}
			if(bandera){
				Swal.fire({
			        title: 'Información',
			        text: "Existen campos obligatorios que no se han registrado",
			        icon: 'info',
			        confirmButtonText: 'Aceptar',
			        allowOutsideClick: () => false
			  })
			  e.preventDefault();
			}
		});
			$('.number').on('input', function() {
				this.value = this.value.replace(/[^0-9]/g, '');
			});
			var inicial = 0;
			var fin = 0;
			$('.inicial').change(function() {
				inicial = $(this).val();
				if (fin != 0) {
					$('.total').val(fin - inicial);
				}

			});
			$('.final').change(function() {
				fin = $(this).val();
				if (inicial != 0) {
					$('.total').val(fin - inicial);
				}

			});
			
			

		});
	</script>
<script type="text/javascript" th:src="@{/js/nhspdd/home.js}"></script>
<script type="text/javascript" th:src="@{/js/src/bootstrap.min.js}"></script>
</html>