<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<div class="col-lg-12 col-md-12">
	
	<button type="button" class="boton-agregar" onclick="crearObraConcreta();" id="btnAgregarObra">
		<img src="css/img/icono-agregar.png" class="agregar" alt="Icono agregar"> Agregar
	</button>
	<br> <br>
	<div class="table-responsive">
		<table id="dtablaObras" class="table-striped" style="width: 175%">
			<thead>
				<tr class="color">
					<th style="width: 5%" class="color-head">Tipo de meta<br><span>&nbsp;&nbsp;</span></th>
					<th style="width: 15%" class="color-head">Meta</th>
					<th style="width: 8%" class="color-head">Obras concretas</th>
					<th style="width: 2%" class="color-head">Acción</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="lista: ${obras}" th:if="${obras != null}">
					<td th:text="${lista.tipoMeta}" />
				    <td th:text="${lista.meta}" />
					<td th:text="${lista.obraConcreta}" />
					<td class="azul"><button class="btnEditarObra" th:attr="onclick=|editarObraConcreta('${lista.idConcreta}','${lista.idMeta}',
					 '${lista.obraConcreta}')|"><img src="css/img/icono-1-azul.png" class="edit-com"></button>
					 <button th:attr="onclick=|eliminarObra('${lista.idConcreta}')|" class="btnEliminarObra">
					<img th:src="@{/css//img/icono-eliminar.png}" class="eliminar-com"></button>
							 
					</td>

				</tr>
			</tbody>
		</table>
	</div>
	<br>
</div>
	<div th:include="ip/programa-gobierno/modal-agregar-obras.html"></div>
	<div th:include="ip/programa-gobierno/modal-editar-obras.html"></div>
<script type="text/javascript">
$(document).ready(function() {
	cargarObras();
});

function editarObraConcreta(idConcreta, idMet, obraConcreta){
	$('#editarObrasModal').modal('show');
	console.log(idMet);
	document.getElementById("idMeta2").value= idMet;
	document.getElementById("idObraConcreta").value= idConcreta;
	document.getElementById("obra").value= obraConcreta;
}
function crearObraConcreta(){
	$('#agregarObrasModal').modal('show');
}
function eliminarObra(idObra){
	Swal.fire({
		  title: '¡Advertencia!',
		  text: "¿Está seguro de eliminar esta obra?",
		  icon: 'warning',
		  showCancelButton: true,
		  confirmButtonColor: '#3085d6',
		  cancelButtonColor: '#d33',
		  confirmButtonText: 'Aceptar',
		  cancelButtonText: 'Cancelar'
		}).then((result) => {
		  if (result.value) {
			window.location = "eliminar-obra/" + idObra;  
		  
		  }
		})
}
function cargarObras(){
    $('#dtablaObras').DataTable({
  	"orderCellsTop": true,
  	"order": [ 0, 'desc' ],
	"columnDefs": [
	    { "orderable": false, "targets":3}
	  ],
  	"processing" : true,
  	"ordering": true,
      "language": {
          "info": '<div class="formato">_END_ de _TOTAL_ registros</div>',
          "infoEmpty": '<div class="formato">0 de 0.</div>',
          "infoFiltered": "(filtrados de un total de _MAX_ registros)",
          "zeroRecords": "No se han encontrado coincidencias.",
          "responsive": true,
          "paginate": {
              "first": '<img src="css/img/icono-flecha-doble-izquierda.png" class="flecha-paginador">',
              "last":  '<img src="css/img/icono-flecha-doble-derecha.png" class="flecha-paginador">',
              "next": '<img src="css/img/icono-flecha-derecha.png" class="flecha-paginador">',
              "previous":'<img src="css/img/icono-flecha-izquierda.png" class="flecha-paginador">'
          },
          "lengthMenu": "_MENU_",
      },

      "lengthMenu": [5, 10, 20, 50, 100],
      "pageLength": 5,
      "pagingType": "full_numbers",
      "dom": "<'row'<'col-sm-5 col-md-7'>>" +
              "<'row'<'col-sm-8 col-md-7'tr>>" +
              "<'row'<'col-sm-8 col-md-7'><'col-sm-2 col-md-1'l><'col-sm-1 col-md-1'i><'col-sm-1 col-md-3'p>>",

  });
$('div.dataTables_length select').addClass("formato-2");
}


</script>
</html>