<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
</head>

<style>
	.total-grupos-etarios {
		font-size: 1.5em;
		padding: 10px 8px !important;
	}

	.fila-tabla-grupos_etarios {
		cursor: pointer;
	}

	.fila-hover-etario {
		cursor: pointer;
	}

	.fila-hover-etario:hover {
		opacity: .9;
	}

	.lds-ellipsis {
		display: inline-block;
		position: relative;
		width: 80px;
		height: 30px;
	}

	.lds-ellipsis div {
		position: absolute;
		top: 6px;
		width: 15px;
		height: 15px;
		border-radius: 50%;
		background: #00529C;
		animation-timing-function: cubic-bezier(0, 1, 1, 0);
	}

	.lds-ellipsis div:nth-child(1) {
		left: 8px;
		animation: lds-ellipsis1 0.6s infinite;
	}

	.lds-ellipsis div:nth-child(2) {
		left: 8px;
		animation: lds-ellipsis2 0.6s infinite;
	}

	.lds-ellipsis div:nth-child(3) {
		left: 32px;
		animation: lds-ellipsis2 0.6s infinite;
	}

	.lds-ellipsis div:nth-child(4) {
		left: 56px;
		animation: lds-ellipsis3 0.6s infinite;
	}

	.active {
		pointer-events: auto;
	}

	.disabled {
		pointer-events: none;
	}


	@keyframes lds-ellipsis1 {
		0% {
			transform: scale(0);
		}

		100% {
			transform: scale(1);
		}
	}

	@keyframes lds-ellipsis3 {
		0% {
			transform: scale(1);
		}

		100% {
			transform: scale(0);
		}
	}

	@keyframes lds-ellipsis2 {
		0% {
			transform: translate(0, 0);
		}

		100% {
			transform: translate(24px, 0);
		}
	}
</style>

<body>
	<div class="abs-center mt-2 " style="font-size: 16px">
		<span><b>Población Objetivo</b></span><br>
		<div class="hr-1"></div>
	</div>
	<!-- TABLA-SUPERIOR -->
	<!-- boton agregar -->
	<div align="left" class="mb-3 mt-3">
		<a href="#">
			<button id="btn_agregar_grupo_etario" class="boton-agregar mt-3" type="button" data-toggle="modal"
				data-target="#agregarGrupoEtarioModal">
				<i class="fa fa-plus-circle"></i> Agregar
			</button>
		</a>
	</div>
	<!-- spinner -->
	<div id="spinner_tabla_grupos_etarios" class="lds-ellipsis text-center">
		<div></div>
		<div></div>
		<div></div>
		<div></div>
	</div>
	<!-- mensajes -->
	<!-- <div id="mensajes_tabla_grupos_etarios" class="alert alert-danger mt-4" role="alert">
	</div> -->
	<!-- boton recargar datos -->
	<!-- <button id="btn_recargar_grupos_etarios" class="btn btn-primary mb-3">Volver a cargar</button> -->
	<!-- tabla grupos etarios -->
	<div class="table-responsive" id="tabla_grupos_etarios">
		<table class="table-striped" style="width: 160%">
			<thead>
				<tr>
					<th class="color-head">Grupo Etario<br></th>
					<!-- <th class="color-head d-none">ID<br></th> -->
					<th class="color-head">Número de Personas<br></th>
					<th class="color-head">Descripción<br></th>

					<th class="color-head">Acción<br></th>
				</tr>
			</thead>
			<tbody>
			</tbody>
			<tfoot>
				<tr>
					<td></td>
					<!-- <td class="d-none"></td> -->
					<td id="totalGruposEtarios" class="font-weight-bold total-grupos-etarios"></td>
					<td></td>
					<td></td>
				</tr>
			</tfoot>
		</table>

	</div>
	<!-- /TABLA-SUPERIOR -->
	<!-- --------------------------------------------------------------------- -->
	<!-- TABLA-INFERIOR -->
	<!-- boton agregar -->
	<div align="left" class="mb-3 mt-3">
		<a href="#">
			<button id="btn_agregar_sector_condicion" class="boton-agregar mt-3" type="button" data-toggle="modal"
				data-target="#agregarGrupoEtnicoModal">
				<i class="fa fa-plus-circle"></i> Agregar
			</button>
		</a>
	</div>
	<!-- spinner -->
	<div id="spinner_tabla_sectores" class="lds-ellipsis d-none text-center">
		<div></div>
		<div></div>
		<div></div>
		<div></div>
	</div>
	<!-- mensajes -->
	<!-- <div id="mensajes_tabla_sectores" class="alert alert-danger mt-4" role="alert">
	</div> -->
	<!-- boton recargar datos -->
	<!-- <button id="btn_recargar_sectores" class="btn btn-primary mb-3">Volver a cargar</button> -->
	<!-- tabla grupos/sectores/condiciones... -->
	<div class="table-responsive" id="tabla_sectores_condiciones">
		<table class="table-striped" style="width: 160%">
			<thead>
				<tr>
					<th class="color-head">Grupos / Situaciones / Condiciones / Sectores<br></th>

					<th class="color-head">Número de Personas<br></th>
					<th class="color-head">Descripción<br></th>

					<th class="color-head">Acción<br></th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
	<!-- /TABLA-INFERIOR -->

	<div class="row mt-3">
		<div class="col-sm-12">
			<div class="texto">
				<label>Enfoque de Género:</label>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-sm-12">
			<textarea rows="" cols="4" class="form-control"></textarea>
		</div>
	</div>
	<div th:include="bp/inscripcion-proyectos/modales/modal-agregar-grupo.html"></div>
	<div th:include="bp/inscripcion-proyectos/modales/modal-agregar-grupo-etnico.html"></div>
<<<<<<< HEAD
	<!-- <script src="js/nhspdd/poblacion-objetivo.js" type="text/javascript"></script> -->
	<script th:inline="javascript">

		$(document).ready(function () {
			let accion = false;

			$("#tab09-action").click(function (e) {
				if (!accion) {
					accion = true;
					let idProyectoInversion = 5;
					let idPoblacionSeleccionado;
					let totalSumaFilaNumeroTablaEtarios = 0;

					let $tablaGruposEtarios = $("#tabla_grupos_etarios");
					let $tablaSectores = $("#tabla_sectores_condiciones");

					agregarCamposDeFiltro($tablaGruposEtarios);
					agregarCamposDeFiltro($tablaSectores);

					// let $dataTableGruposEtarios = crearDataTable($tablaGruposEtarios);
					// let $dataTableSectores = crearDataTable($tablaSectores);
					let $dataTableGruposEtarios;
					let $dataTableSectores = crearDataTable($tablaSectores);

					$(".filter").on("click", function (e) {
						e.stopPropagation();
					});

					/**
					 * @description elementos dom para la interaccion de la tabla GRUPOS ETARIOS
					 * @constant $btnAgregarGrupoEtario -->> boton de agregar "grupo etario"
					 * @constant $spinnerTablaGruposEtarios -->> spinner usado para la interaccion de las peticiones
					 */
					let $btnAgregarGrupoEtario = $("#btn_agregar_grupo_etario");
					let $spinnerTablaGruposEtarios = $("#spinner_tabla_grupos_etarios");

					/**
					 * @description elementos dom para la interaccion de la tabla SECTORES
					 * @constant $btnAgregarGrupoEtario -->> boton de agregar "sector"
					 * @constant $spinnerTablaGruposEtarios -->> spinner usado para la interaccion de las peticiones
					 */
					let $btnAgregarSector = $("#btn_agregar_sector_condicion");
					let $spinnerTablaSectores = $("#spinner_tabla_sectores");
					cambiarEstadoTablaSectores("inicial");
					cambiarEstadoTablaGruposEtarios("inicial");

					//Select2
					$(".js-selector-single-grupo-etario").select2();
					$(".js-selector-single-sector-condicion").select2();

					function limpiarFormularioEtarios() {
						$("#selectorAggEtarioId").attr("readonly", false);
						$("#selectorAggEtarioId").attr("disabled", false);
						$("#selectorAggEtarioId").removeClass("requerido");
						$("#campoDescAdd").attr("readonly", false);

						//limpiarCampos
						$("#campoNumeroAdd").val("");
						$("#campoNumeroAdd").removeClass("requerido");
						$("#campoDescAdd").val("");
						$("#selectorAggEtarioId").val([]);

						//setear idPoblacion para no tener un valor guardado
						$("#campoEditarIdPoblacion").val(null);

					}

					function limpiarFormularioSectoresCondiciones() {
						$("#selectorAggSectorCondicionId").attr("readonly", false);
						$("#selectorAggSectorCondicionId").attr("disabled", false);
						$("#selectorAggSectorCondicionId").removeClass("requerido");
						$("#camboDescAddSectorCondicion").attr("readonly", false);

						//limpiarCampos
						$("#camboNumeroAddSectorCondicion").val("");
						$("#camboNumeroAddSectorCondicion").removeClass("requerido");
						$("#camboDescAddSectorCondicion").val("");
						$("#selectorAggSectorCondicionId").val([]);

						//setear idEtnico para no tener un valor guardado
						$("#campoEditarIdEtnico").val(null);

					}

					function bloquearFormularioEtariosEditar() {
						$("#selectorAggEtarioId").attr("readonly", true);
						$("#selectorAggEtarioId").attr("disabled", true);
						$("#campoDescAdd").attr("readonly", true);
					}

					function excluirFormularioAgregarEtario() {
						$("#campoDescAdd").attr("readonly", true);
						$("#campoDescAdd").attr("disabled", true);
						$("#campoNumeroAdd").attr("readonly", true);
						$("#campoNumeroAdd").attr("disabled", true);
						//limpiarCampos
						$("#campoNumeroAdd").val("");
						$("#campoDescAdd").val("");
					}

					function quitarExcluirFormularioAgregarEtario() {
						$("#campoDescAdd").attr("readonly", false);
						$("#campoDescAdd").attr("disabled", false);
						$("#campoNumeroAdd").attr("readonly", false);
						$("#campoNumeroAdd").attr("disabled", false);
					}


					function cambiarEstadoTablaGruposEtarios(accion) {
						switch (accion) {
							case "inicial":
								$btnAgregarGrupoEtario.addClass("d-none");
								$spinnerTablaGruposEtarios.addClass("d-none");
								$tablaGruposEtarios.removeClass("d-none");
								break;
							case "cargando":
								$btnAgregarGrupoEtario.addClass("d-none");
								$spinnerTablaGruposEtarios.removeClass("d-none");
								$tablaGruposEtarios.removeClass("d-none");
								break;
							case "bien_y_con_datos":
								$btnAgregarGrupoEtario.removeClass("d-none");
								$spinnerTablaGruposEtarios.addClass("d-none");
								$tablaGruposEtarios.removeClass("d-none");
								break;
							case "bien_y_sin_datos":
								$btnAgregarGrupoEtario.removeClass("d-none");
								$spinnerTablaGruposEtarios.addClass("d-none");
								$tablaGruposEtarios.removeClass("d-none");
								break;
							case "fallida":
								$btnAgregarGrupoEtario.addClass("d-none");
								$spinnerTablaGruposEtarios.addClass("d-none");
								$tablaGruposEtarios.removeClass("d-none");
								break;

							default:
								break;
						}
					}

					function cambiarEstadoTablaSectores(accion) {
						switch (accion) {
							case "inicial":
								$btnAgregarSector.addClass("d-none");
								$spinnerTablaSectores.addClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;
							case "cargando":
								$btnAgregarSector.addClass("d-none");
								$spinnerTablaSectores.removeClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;
							case "bien_y_con_datos":
								$btnAgregarSector.removeClass("d-none");
								$spinnerTablaSectores.addClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;
							case "bien_y_sin_datos":
								$btnAgregarSector.removeClass("d-none");
								$spinnerTablaSectores.addClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;
							case "fallida":
								$btnAgregarSector.addClass("d-none");
								$spinnerTablaSectores.addClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;
							case "no_aplica":
								$btnAgregarSector.addClass("d-none");
								$spinnerTablaSectores.addClass("d-none");
								$tablaSectores.removeClass("d-none");
								break;

							default:
								break;
						}
					}

					function agregarCamposDeFiltro($table) {
						$table.find("table thead th").each(function () {
							let title = $(this).text();
							if (title !== "Acción") {
								$(this).html(
									'<div class="form-group" id="centrado2">' +
									'<label for="th" class="blanco">' +
									title +
									"</label>" +
									'<div class="centrado">' +
									'<input class="form-control filter" id="nombre1" type="text"  placeholder="&#xf0b0; Filtrar ' +
									title +
									'" />' +
									"</div>" +
									"</div>"
								);
							}
						});
					}

					function agregarFiltrosDataTable($dataTable) {
						$dataTable.columns().every(function () {
							let that = this;

							$("input", this.header()).on("keyup change clear", function () {
								if (that.search() !== this.value) {
									that.search(this.value).draw();
								}
							});
						});
					}

					function accionFila(idPoblacion, numero) {
						// >>>>>>>>> reinicializarDatatableSectores
						$dataTableSectores.clear();
						$dataTableSectores.destroy();
						// >>>>>>>>>reinicializarDatatableSectores
						idPoblacionSeleccionado = idPoblacion;
						if (numero === 0) {
							$btnAgregarSector.addClass("d-none");
							$dataTableSectores = crearDataTable($tablaSectores);

						} else {
							$btnAgregarSector.removeClass("d-none");

							ajaxSectores(idPoblacion);
						}
					}

					function crearDataTable($element) {
						let $dataTableCreado = $element.find("table").DataTable({
							language: {
								info: '<div class="formato">_END_ de _TOTAL_ registros</div>',
								infoEmpty: '<div class="formato">0 de 0.</div>',
								infoFiltered: "(filtrados de un total de _MAX_ registros)",
								zeroRecords: "No hay información para mostrar",
								responsive: true,
								paginate: {
									first:
										'<img src="css/img/icono-flecha-doble-izquierda.png" class="flecha-paginador">',
									last:
										'<img src="css/img/icono-flecha-doble-derecha.png" class="flecha-paginador">',
									next:
										'<img src="css/img/icono-flecha-derecha.png" class="flecha-paginador">',
									previous:
										'<img src="css/img/icono-flecha-izquierda.png" class="flecha-paginador">',
								},
								lengthMenu: "_MENU_",
								columnDefs: [
									{
										targets: -1,
										data: null,
										defaultContent: '<button class"btn btn-primary">editar<button>',
									},
								],
							},
							initComplete: function (settings, json) { },
							lengthMenu: [5, 10, 20, 50, 100],
							pageLength: 5,
							pagingType: "full_numbers",
							dom:
								"<'row'<'col-sm-5 col-md-7'>>" +
								"<'row'<'col-sm-8 col-md-7'tr>>" +
								"<'row'<'col-sm-8 col-md-7'><'col-sm-2 col-md-1'l><'col-sm-1 col-md-1'i><'col-sm-1 col-md-3'p>>",
						});

						agregarFiltrosDataTable($dataTableCreado);
						return $dataTableCreado;
					}

					function ajaxGruposEtarios() {
						totalSumaFilaNumeroTablaEtarios = 0;
						cambiarEstadoTablaGruposEtarios("cargando");
						$.ajax({
							type: "GET",
							url: "/Segplan/" + "obtenerPoblacion/" + idProyectoInversion,
							success: function (data) {
								let idFilaGrupoEtario = 1;
								if (data.lstObjectsDTO.length === 0) {
									cambiarEstadoTablaGruposEtarios("bien_y_sin_datos");
								} else {
									cambiarEstadoTablaGruposEtarios("bien_y_con_datos");

									data.lstObjectsDTO.forEach(function (item) {
										contenido = "";
										totalSumaFilaNumeroTablaEtarios += item.numero;

										let selectorFila = `fila-tabla-grupos-etarios-id-${idFilaGrupoEtario++}`;
										let btnEditar = `
										<button  id="editar-grupo-etario-${item.idPoblacion}" class="btnAction">
											<img src="css/img/icono-1-azul.png">
										</button>
										`;
										let btnEliminar = `
										<button id="eliminar-grupo-etario-${item.idPoblacion}" class="btnAction">
											<img src="css/img/icono-eliminar.png">
										</button>
										`;
										let acciones = `
										<div class="centrarItems">
											${btnEditar}
											${btnEliminar}
										</div>
										`;
										//Validacion descripcion vacia
										let row;
										if (item.descripcion) {
											row = `
										<tr class='fila-hover-etario ${selectorFila}'>
											<td>${item.stringLsEtario}</td>
											<td>${item.numero}</td>
											<td>${item.descripcion}</td>
											<td>${acciones}</td>
										</tr>
										`;
										} else {
											row = `
										<tr class='fila-hover-etario ${selectorFila}'>
											<td>${item.stringLsEtario}</td>
											<td>${item.numero}</td>
											<td></td>
											<td>${acciones}</td>
										</tr>
										`;
										}
										contenido += row;
										$tablaGruposEtarios.find("table tbody").append(contenido);
										$(`#editar-grupo-etario-${item.idPoblacion}`).click((e) => {
											e.stopPropagation();
											let idPoblacion = item.idPoblacion
											let numero = item.numero
											let descripcion = item.descripcion
											let idLsEtario = item.idLsEtario
											let StringLsEtario = item.stringLsEtario

											//mostrar input string detalle
											$("#campoDescAdd").val(descripcion);
											$("#campoDescAdd").attr("readonly", true);

											//mostrar input string numero
											$("#campoNumeroAdd").val(numero);
											// $("#campoNumeroAdd").attr("readonly", true);

											//mostrar selector
											$("#selectorAggEtarioId").val(idLsEtario);
											$("#selectorAggEtarioId").attr("readonly", true);
											$("#selectorAggEtarioId").attr("disabled", true);

											//setear idPoblacion
											$("#campoEditarIdPoblacion").val(idPoblacion);


											$("#agregarGrupoEtarioModal").modal("show");
											//VOLVERR
											//ajaxAgregarActualizarGrupoEtario();

										});
										$(`#eliminar-grupo-etario-${item.idPoblacion}`).click((e) => {
											e.stopPropagation();
											Swal.fire({
												title: '¡Advertencia!',
												text: "¿Está seguro de eliminar este registro?",
												type: "warning",
												showCancelButton: true,
												confirmButtonColor: '#3085d6',
												cancelButtonColor: '#d33',
												confirmButtonText: 'Aceptar',
												cancelButtonText: 'Cancelar'
											}).then((result) => {
												if (result.value) {
													ajaxEliminarGrupoEtario(item.idPoblacion);
												}
											})
										});
										$(`.${selectorFila}`).click(() => accionFila(item.idPoblacion, item.numero));

									});

								}
								$dataTableGruposEtarios = crearDataTable($tablaGruposEtarios);
								// $("#editar-grupo-etario-4").on("click", function (e) {
								//   e.stopPropagation();
								// });
								$("#totalGruposEtarios").html(`Total: ${totalSumaFilaNumeroTablaEtarios}`);
								$("#campoTotalSumaEtarios").val(totalSumaFilaNumeroTablaEtarios)
							},
							error: function () {
								cambiarEstadoTablaGruposEtarios("fallida");
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function (data) { },
						});
					}

					function ajaxAgregarActualizarSector(dataSerialize) {

						$.ajax({
							type: "POST",
							url: '/Segplan/' + 'registrarSectorCondicion/' + idPoblacionSeleccionado,
							data: dataSerialize,
							beforeSend: function () {
								Swal.fire({
									title: 'Cargando...',
									allowOutsideClick: () => !Swal.isLoading(),
									onBeforeOpen: () => {
										Swal.showLoading();
									}
								});
							},
							success: function (response) {
								switch (response.msgRespuesta) {
									case "Registro realizado exitosamente":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableSectores
											// $dataTableGruposEtarios.clear();
											// $dataTableGruposEtarios.destroy();
											$dataTableSectores.clear();
											$dataTableSectores.destroy();
											// >>>>>>>>>reinicializarDatatableSectores
											ajaxSectores(idPoblacionSeleccionado);
											limpiarFormularioSectoresCondiciones();//
											$("#agregarGrupoEtnicoModal").modal("hide");
										})
										break;
									case "Registro modificado con éxito":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableSectores
											// $dataTableGruposEtarios.clear();
											// $dataTableGruposEtarios.destroy();
											$dataTableSectores.clear();
											$dataTableSectores.destroy();
											// >>>>>>>>>reinicializarDatatableSectores
											ajaxSectores(idPoblacionSeleccionado);
											limpiarFormularioSectoresCondiciones();//
											$("#agregarGrupoEtnicoModal").modal("hide");
										})
										break;
									default:
										Swal.close();
										Swal.fire({
											title: "¡Información!",
											text: response.msgRespuesta,
											type: "info",
											confirmButtonText: 'Aceptar',
											allowOutsideClick: () => false
										})
										break;
								}

							}, error: function () {
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function (data) {

							},
						});
					}

					function ajaxAgregarActualizarGrupoEtario(dataSerialize) {
						$.ajax({
							type: "POST",
							url: '/Segplan/' + 'registrarGruposEtarios/' + idProyectoInversion,
							data: dataSerialize,
							beforeSend: function () {
								Swal.fire({
									title: 'Cargando...',
									allowOutsideClick: () => !Swal.isLoading(),
									onBeforeOpen: () => {
										Swal.showLoading();
									}
								});
							},
							success: function (response) {
								switch (response.msgRespuesta) {
									case "Grupo etario creado exitosamente":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableEtarios
											$dataTableGruposEtarios.clear();
											$dataTableGruposEtarios.destroy();
											// >>>>>>>>>reinicializarDatatableEtarios
											ajaxGruposEtarios();
											limpiarFormularioEtarios();
											$("#agregarGrupoEtarioModal").modal("hide");
										})
										break;
									case "Se ha realizado correactamente la modificación":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableEtarios
											$dataTableGruposEtarios.clear();
											$dataTableGruposEtarios.destroy();
											// >>>>>>>>>reinicializarDatatableEtarios
											ajaxGruposEtarios();
											limpiarFormularioEtarios();
											$("#agregarGrupoEtarioModal").modal("hide");
										})
										break;
									default:
										Swal.close();
										Swal.fire({
											title: "¡Información!",
											text: response.msgRespuesta,
											type: "info",
											confirmButtonText: 'Aceptar',
											allowOutsideClick: () => false
										})
										break;
								}

							}, error: function () {
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function (data) {

							},
						});
					}

					function ajaxEliminarSector(idEtnico) {
						let data;
						$.ajax({
							type: "POST",
							url: "/Segplan/eliminarSector/" + idEtnico,
							data: data,
							beforeSend: function () {
								Swal.fire({
									title: 'Cargando...',
									allowOutsideClick: () => !Swal.isLoading(),
									onBeforeOpen: () => {
										Swal.showLoading();
									}
								});
							},
							success: function (response) {
								switch (response.msgRespuesta) {
									case "Registro eliminado con éxito":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableSectores
											// $dataTableGruposEtarios.clear();
											// $dataTableGruposEtarios.destroy();
											$dataTableSectores.clear();
											$dataTableSectores.destroy();
											// >>>>>>>>>reinicializarDatatableSectores
											ajaxSectores(idPoblacionSeleccionado);
											limpiarFormularioSectoresCondiciones();//
											//$("#agregarGrupoEtnicoModal").modal("hide");
										})
										break;
									default:
										Swal.close();
										Swal.fire({
											title: "¡Información!",
											text: response.msgRespuesta,
											type: "info",
											confirmButtonText: 'Aceptar',
											allowOutsideClick: () => false
										})
										break;
								}

							},
							error: function () {
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function (data) {
							},
						});
					}

					function ajaxEliminarGrupoEtario(idPoblacion) {
						let data;
						$.ajax({
							type: "POST",
							url: "/Segplan/eliminarGrupoEtario/" + idPoblacion,
							data: data,
							beforeSend: function () {
								Swal.fire({
									title: 'Cargando...',
									allowOutsideClick: () => !Swal.isLoading(),
									onBeforeOpen: () => {
										Swal.showLoading();
									}
								});
							},
							success: function (response) {
								switch (response.msgRespuesta) {
									case "Se ha eliminado correctamente el grupo etario":
										Swal.close();
										Swal.fire({
											title: 'Operación exitosa!',
											text: response.msgRespuesta,
											type: 'success',
											allowOutsideClick: () => false
										}).then(() => {
											// >>>>>>>>>reinicializarDatatableEtarios
											$dataTableGruposEtarios.clear();
											$dataTableGruposEtarios.destroy();
											// >>>>>>>>>reinicializarDatatableEtarios
											ajaxGruposEtarios();
										})
										break;
									default:
										Swal.close();
										Swal.fire({
											title: "¡Información!",
											text: response.msgRespuesta,
											type: "info",
											confirmButtonText: 'Aceptar',
											allowOutsideClick: () => false
										})
										break;
								}

							},
							error: function () {
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function (data) {
							},
						});
					}

					function ajaxSectores(idGrupoEtario) {
						cambiarEstadoTablaSectores("cargando");
						$(".fila-hover-etario").addClass("disabled");
						$.ajax({
							type: "GET",
							url: "/Segplan/obtenerSectores/" + idGrupoEtario,
							success: function (response) {

								if (response.lstObjectsDTO.length === 0) {
									cambiarEstadoTablaSectores("bien_y_sin_datos");
								} else {
									cambiarEstadoTablaSectores("bien_y_con_datos");

									response.lstObjectsDTO.forEach(function (item) {
										contenido = "";
										let btnEditar = `
										<button id="editar-sector-condicion-${item.idEtnico}" class="btnAction">
											<img src="css/img/icono-1-azul.png">
										</button>
										`;
										let btnEliminar = `
										<button id="eliminar-sector-condicion-${item.idEtnico}" class="btnAction">
											<img src="css/img/icono-eliminar.png">
										</button>
										`;
										let acciones = `
										<div class="centrarItems">
											${btnEditar}
											${btnEliminar}
										</div>
										`;
										let row;
										if (item.descripcion) {
											row = `
										<tr class='fila-hover'>
											<td>${item.stringLsEtnico}</td>
											<td>${item.numero}</td>
											<td>${item.descripcion}</td>
											<td>${acciones}</td>
										</tr>
										`;
										} else {
											row = `
										<tr class='fila-hover'>
											<td>${item.stringLsEtnico}</td>
											<td>${item.numero}</td>
											<td></td>
											<td>${acciones}</td>
										</tr>
										`;
										}
										contenido += row;
										$tablaSectores.find("table tbody").append(contenido);

										$(`#editar-sector-condicion-${item.idEtnico}`).click(() => {
											e.stopPropagation();
											let idEtnico = item.idEtnico
											let numero = item.numero
											let descripcion = item.descripcion
											let idLsEtnico = item.idLsEtnico
											let stringLsEtnico = item.stringLsEtnico
											console.log("----idEtnico", idEtnico)

											//mostrar input string detalle
											$("#camboDescAddSectorCondicion").val(descripcion);
											$("#camboDescAddSectorCondicion").attr("readonly", true);

											//mostrar input string numero
											$("#camboNumeroAddSectorCondicion").val(numero);
											// $("#campoNumeroAdd").attr("readonly", true);

											//mostrar selector
											$("#selectorAggSectorCondicionId").val(idLsEtnico);
											$("#selectorAggSectorCondicionId").attr("readonly", true);
											$("#selectorAggSectorCondicionId").attr("disabled", true);

											//setear idEtnico
											$("#campoEditarIdEtnico").val(idEtnico);


											$("#agregarGrupoEtnicoModal").modal("show");
											//VOLVERR
											//ajaxAgregarActualizarGrupoEtario();
										}
										);
										$(`#eliminar-sector-condicion-${item.idEtnico}`).click(() => {
											e.stopPropagation();
											Swal.fire({
												title: '¡Advertencia!',
												text: "¿Está seguro de eliminar este registro?",
												type: "warning",
												showCancelButton: true,
												confirmButtonColor: '#3085d6',
												cancelButtonColor: '#d33',
												confirmButtonText: 'Aceptar',
												cancelButtonText: 'Cancelar'
											}).then((result) => {
												if (result.value) {
													//ajaxEliminarGrupoEtario(item.idPoblacion);
													//alert("eliminar");
													ajaxEliminarSector(item.idEtnico);
												}
											})

										}
										);
									});

								}
								$dataTableSectores = crearDataTable($tablaSectores);
							},
							error: function () {
								cambiarEstadoTablaSectores("fallida");
								Swal.close();
								Swal.fire({
									type: 'error',
									title: 'Oops...',
									text: 'Algo salio mal',
									// footer: "No tiene conexión a internet por favor verifique la conexión e intente nuevamente."
								})
							},
							complete: function () {
								$(".fila-hover-etario").removeClass("disabled");
							},
						});
					}

					function modalAgregar() {

						$('#campoNumeroAdd').on('input', function () {
							this.value = this.value.replace(/[^0-9]/g, '');
							$("#campoNumeroAdd").removeClass("requerido");
						});

						$('#camboNumeroAddSectorCondicion').on('input', function () {
							this.value = this.value.replace(/[^0-9]/g, '');
							$("#camboNumeroAddSectorCondicion").removeClass("requerido");
						});

						$("#btnCancelarModalAggEtario").click(function (e) {
							e.preventDefault();
							limpiarFormularioEtarios();

						});

						$("#btnCancelarModalAggSector").click(function (e) {
							e.preventDefault();
							limpiarFormularioSectoresCondiciones();

						});

						$("#btnEquisModalAggEtario").click(function (e) {
							e.preventDefault();
							limpiarFormularioEtarios();

						});
						$("#btnEquisModalAggSector").click(function (e) {
							e.preventDefault();
							limpiarFormularioSectoresCondiciones();

						});

						$('#selectorAggEtarioId').on('change', function (e) {
							$("#selectorAggEtarioId").removeClass("requerido");
							let selectedValueText = $("#selectorAggEtarioId").children("option:selected").attr("data-text-noige");
							if (selectedValueText.trim() === "NOIGE") {
								excluirFormularioAgregarEtario();
								return;
							} else {
								quitarExcluirFormularioAgregarEtario();
								return;
							}
						});

						$('#selectorAggSectorCondicionId').on('change', function (e) {
							$("#selectorAggSectorCondicionId").removeClass("requerido");

						});

						//-------------Accion de Guardar Sector ------------------------------
						$(document).on('submit', '#formAgregarSectorCondicion', function (e) {
							e.preventDefault();

							let variables = $('.required-add-sector-condicion');
							let contador = variables.length;
							console.log("contador-----", contador);
							let selectedValueText = $("#selectorAggSectorCondicionId").children("option:selected").text();
							let selectedValueId = $("#selectorAggSectorCondicionId").children("option:selected").val();
							console.log("selectedValueText-----", selectedValueText);
							console.log("selectedValueId-----", selectedValueId);

							let validacion = true;
							for (var i = 0; i < variables.length; i++) {
								if ($(variables[i]).val() == '' || $(variables[i]).val() == undefined) {
									$(variables[i]).addClass("requerido");
									validacion = false;
								} else {
									$(variables[i]).removeClass("requerido");
								}
							}


							if (!validacion) {
								Swal.fire({
									title: 'Información',
									text: "Existen campos obligatorios que no se han registrado",
									type: 'warning',
									confirmButtonText: 'Aceptar',
									allowOutsideClick: () => false
								});
							} else {
								let data = $(this).serialize();
								console.log("-----data", data)
								console.log(idPoblacionSeleccionado);
								ajaxAgregarActualizarSector(data);
							}

						});

						//-------------Accion de Guardar ------------------------------
						$(document).on('submit', '#formAgregarGruposEtarios', function (e) {
							e.preventDefault();

							// >>>>>>>>>>inicio validacion campos>>>>>>>>>>>>
							//validacion seleccion multiple
							let variables = $('.required-add-etario');
							let contador = variables.length;
							let selectedValueText = $("#selectorAggEtarioId").children("option:selected").attr("data-text-noige");
							let selectedValueId = $("#selectorAggEtarioId").children("option:selected").val();

							let validacionGeneral = true;
							let validacionNOIGE = true;

							if (selectedValueText) {
							} else {
								selectedValueText = "";
							}

							if (selectedValueText.trim() === "NOIGE") {
								validacionGeneral = true;
								validacionNOIGE = false;
							} else {
								validacionGeneral = true;
								validacionNOIGE = true;
							}

							if (validacionNOIGE) {
								for (var i = 0; i < variables.length; i++) {
									if ($(variables[i]).val() == '' || $(variables[i]).val() == undefined) {
										$(variables[i]).addClass("requerido");
										validacionGeneral = false;
									} else {
										$(variables[i]).removeClass("requerido");
									}
								}
							}

							if (!validacionGeneral) {
								Swal.fire({
									title: 'Información',
									text: "Existen campos obligatorios que no se han registrado",
									type: 'warning',
									confirmButtonText: 'Aceptar',
									allowOutsideClick: () => false
								});
							} else {
								// enviar peticion de guardar//

								let data = $(this).serialize();
								ajaxAgregarActualizarGrupoEtario(data);


							}


						});

					}

					function main() {
						ajaxGruposEtarios();
						modalAgregar();
					}

					main();
				}
			});
		});
=======
	<script type="text/javascript">
		$(document).ready(function (){
			data = $(this).serialize();
	        $.ajax({
	             type: 'GET',
	             url: '/Segplan/'+'obtenerPoblacion/5',
	             data: data,
	             success: function (data) {
	                 console.log(data);
	                 
	             },
	             complete: function (data){


	             }
	        });
		})
>>>>>>> developer
	</script>
</body>

</html>