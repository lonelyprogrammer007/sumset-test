<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:include="/header :: headFragment">
<meta charset="UTF-8">
<title id="pageTitle">Plantilla de notificación</title>
</head>
<link rel="stylesheet" type="text/css" th:href="@{/css/afs/listas.css}">
<link rel="stylesheet" type="text/css" th:href="@{/css/modal/modal.css}">
<script type="text/javascript" th:src="@{/js/nhspdd/datatable-consultas.js}"></script>
<body>
	<header th:replace="/home:: header"></header>


	<nav aria-label="breadcrumb">
		<ul class="breadcrumb" id="migas">
			<li class="breadcrumb-item"><em class="fa fa-home">&nbsp;&nbsp;|&nbsp;&nbsp;</em><a
				>Administración funcional</a></li>
			<li class="breadcrumb-item">Mensajería y notificaciones</li>	
			<li class="breadcrumb-item active" aria-current="page" id="act">Plantillas
				de notificaciones</li>
		</ul>
	</nav>
	<div class="form-container3">

		<div class="abs-center">
			<span>Plantilla de notificaciones</span> <br>
		</div>
		<div class="hr-1"></div>
		<br>

		<div class="table-responsive">
			<table id="dtablaPlantilla" class="table-striped" style="width: 250%">
			<caption><div class="hr-2"></div></caption>
				<thead>
					<tr>
						<th id="ocho">Código</th>
						<th id="treinta">Asunto</th>
						<th id="quince">Modulo que lo origina</th>
						<th id="quince">Operación que lo origina</th>
						<th id="quince">Tipo de notificacion</th>
						<th id="diez">Estado</th>
						<th id="cinco"><div class="subir">Acción</div></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="lista: ${listaNotificaciones}"
						th:if="${lista.idConfigNotificacion !=-1}">

						<td style="text-align: right;" th:text="${lista.idConfigNotificacion}" />
						<td th:text="${lista.asunto}" />
						<td th:text="${lista.moduloOrigen}" />
						<td th:text="${lista.operacionOrigen}" />
						<td>Automatica</td>
						<td><span th:if="${lista.estado == 1}">Activo</span><span
							th:if="${lista.estado == 0}">Inactivo</span></td>
						<td><a
							th:attr="onclick=|editarPlantilla('${lista.idConfigNotificacion}',
							'${lista.asunto}','${lista.moduloOrigen}','${lista.operacionOrigen}','${lista.mensaje}','${lista.requiereAccion}','${lista.enviarCorreo}','${lista.estado}')|"><img
								src="css/img/icono-1-azul.png" class="editar" alt="Icono editar"></a></td>
					</tr>

				</tbody>
			</table>

		</div>
		<br>

	</div>
	<br>


	<footer th:replace="/home:: footer"></footer>
	<div th:include="afs/buzon-notificaciones/modal-editar-plantilla.html"></div>
	<div th:include="afs/autenticacion/modal-cambiar-contrasena.html"></div>

</body>
<script th:inline="javascript">
$(document).ready(function() {
	/*<![CDATA[*/
    var mensaje = /*[[${messagePlantilla}]]*/;	
	
	if (mensaje != null){
    Swal.fire({
        title:"¡Advertencia!",
	    text: "Se ha modificado la notificación correctamente",
        icon: "warning",
        confirmButtonText: 'Aceptar',
    
      allowOutsideClick: () => false
    })
}
});
	
    /*]]>*/	


	function editarPlantilla(id, asunto, moduloOr, operacionOr, mensaj, accion, correo, estado) {
		
		$('#modalEditarPlantilla').modal('show');
		document.getElementById("idConfigNotificacion").value = id;
		document.getElementById("asunto").value = asunto;
		document.getElementById("module").value = moduloOr;
		document.getElementById("moduloOrigen").value = moduloOr;
		document.getElementById("operation").value = operacionOr;
		document.getElementById("operacionOrigen").value = operacionOr;
		document.getElementById("accionReque").value = mensaj;
		$('#requiereAccion').text($('#requiereAccion').val(accion));
		$('#enviarCorreo').text($('#enviarCorreo').val(correo));
		$('#estado').text($("#estado")).val(estado);

		var action = document.getElementById("requiereAccion").value;
		var correoPlantilla = document.getElementById("enviarCorreo").value;
		var estadoPlantilla = document.getElementById("estado").value;
		if (action == 1) {
			$("input[type=checkbox]").eq(0).prop("checked", true);

		} else if (action == 0) {
			$("input[type=checkbox]").eq(0).prop("checked", false);
		}

		if (correoPlantilla == 1) {
			$("input[type=checkbox]").eq(1).prop("checked", true);

		} else if (correoPlantilla == 0) {
			$("input[type=checkbox]").eq(1).prop("checked", false);
		}
		if (estadoPlantilla == 1) {
			$("input[type=checkbox]").eq(2).prop("checked", true);

		} else if (estadoPlantilla == 0) {
			$("input[type=checkbox]").eq(2).prop("checked", false);
		}

	}
</script>
<script type="text/javascript" th:src="@{/js/nhspdd/home.js}"></script>
<script type="text/javascript" th:src="@{/js/src/bootstrap.min.js}"></script>
</html>