<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:include="/header :: headFragment">
<meta charset="UTF-8">
<title id="pageTitle">Administrar listas simples</title>
</head>
<link rel="stylesheet" type="text/css" th:href="@{/css/afs/listas.css}">
<link rel="stylesheet" type="text/css" th:href="@{/css/filtros/yadcf-consultar-ls.css}">
<body>
	<header th:replace="/home:: header"></header>


	<nav aria-label="breadcrumb">
		<ul class="breadcrumb" id="migas">
			<li class="breadcrumb-item"><em class="fa fa-home">&nbsp;&nbsp;|&nbsp;&nbsp;</em><a
				>Administracion funcional</a></li>
			<li class="breadcrumb-item">Entidades, tablas, párametros y consecutivos</li>	
			<li class="breadcrumb-item active" aria-current="page" id="act">Listas simples</li>
		</ul>
	</nav>


	<div class="form-container3">

		<div class="abs-center">
			<span>Administrar listas simples</span><br>
		</div>
		<div class="hr-1"></div>
		<br>

		<div class="table-responsive">

		    <form th:action="@{/argumento-ls}" th:object="${listaSimple}" method="POST">
		    <input type="hidden" id="idListaSimple" name="idListaSimple">
		    <input type="hidden" id="nombre" name="nombre">
		    <input type="hidden" id="descripcion" name="descripcion">
			<table id="dtabla" class="table-striped" style="width:175%">
			<caption><div class="hr-2"></div></caption>
				<thead>
					<tr class="color">
						<th id="treinta" class="color-head">Nombre<br></th>
						<th id="sesenta" class="color-head">Descripción<br></th>
						<th id="diez" class="color-head"><div class="subir">Acción</div></th>
					</tr>
				</thead>
				<tbody>

				</tbody>
			</table>
			
			</form>
		
		</div>
		<br>
	</div>
	<br>
	<footer th:replace="/home:: footer"></footer>
	<div th:include="afs/autenticacion/modal-cambiar-contrasena.html"></div>
</body>
<script th:inline="javascript">

	$(document).ready(function() {
		
		cargarDatos();
	});
	function cargarDatos() {
        'use strict';
        $.fn.DataTable.ext.pager.numbers_length = 5;
       	var table = $('#dtabla')
				.DataTable(
						{
							"processing" : true,
							"serverSide" : true,
							"orderCellsTop": true,
							"lengthChange" : true,
							"searching" : true,
							"info" : true,
							"autoWidth" : true,
							"lengthMenu" : [ [ 5, 10, 25, 50, -1 ],
									[ 5, 10, 25, 50, "Mostrar Todo" ] ],
							"pageLength" : 5,
							"language" : {
								"processing" : 'Cargando...',
								"info" : '<div class="formato">_END_ de _TOTAL_ registros</div>',
								"infoEmpty" : '<div class="formato">0 de 0.</div>',
								"infoFiltered" : "(filtrados de un total de _MAX_ registros)",
								"zeroRecords" : "No se han encontrado coincidencias.",
								"responsive" : true,
								"paginate" : {
									"first" : '<img src="css/img/icono-flecha-doble-izquierda.png" class="flecha-paginador">',
									"last" : '<img src="css/img/icono-flecha-doble-derecha.png" class="flecha-paginador">',
									"next" : '<img src="css/img/icono-flecha-derecha.png" class="flecha-paginador">',
									"previous" : '<img src="css/img/icono-flecha-izquierda.png" class="flecha-paginador">'
								},
								"lengthMenu" : "_MENU_",
							},
							"pagingType" : "full_numbers",
							"dom" : "<'row'<'col-sm-5 col-md-7'>>"
									+ "<'row'<'col-sm-8 col-md-7 mb-1'tr>>"
									+ "<'row'<'col-sm-8 col-md-6'><'col-sm-2 col-md-1'l><'col-sm-1 col-md-2'i><'col-sm-1 col-md-3'p>>",

							"order": [0, 'desc'],
							"ajax" : {
								"url" : "/Segplan/queryByPage",
								"type" : "POST"
							},
							"columns" : [
									{
										data : "nombre"
									},
									{
										data : "descripcion"
									},

									{
										"render" : function() {
											return '<button href="" type="submit" id="ButtonEditar" class="ver">Ver</button>';
										},
										"orderable" : false
									}, ],

						})
	
		yadcf.init(table, [ {
			column_number : 0,
			filter_type : "text",
			filter_reset_button_text : false,
			filter_delay : 500

		}, {
			column_number : 1,
			filter_type : "text",
			filter_reset_button_text : false,
			filter_delay : 500
		} ]);
		$('div.dataTables_length select').addClass("formato-2");
		ver("#dtabla tbody",table);
		setInterval( function () {
		    console.log('reloading table')
		    table.ajax.reload( null, false ); // user paging is not reset on reload
		  }, 3600000);

	}

	function ver(tbody, table) {
		$(tbody)
				.on(
						"click",
						"button.ver",
						function() {
							if (table.row(this).child.isShown()) {
								var data = table.row(this).data();
							} else {
								var data = table.row($(this).parents("tr"))
										.data();
							}
							var data = table.row($(this).parents("tr")).data();
							document.getElementById("idListaSimple").value = data.idListaSimple;
							document.getElementById("nombre").value = data.nombre;
							document.getElementById("descripcion").value = data.descripcion;
							
						})
	}
</script>
<script type="text/javascript"
	th:src="@{/js/src/jquery.dataTables.yadcf.js}"></script>
<script type="text/javascript" th:src="@{/js/nhspdd/home.js}"></script>
<script type="text/javascript" th:src="@{/js/src/bootstrap.min.js}"></script>
</html>